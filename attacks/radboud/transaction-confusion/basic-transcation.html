<!DOCTYPE html>
<html>
  <head>
    <title>BasicTransaction attack</title>
    <link href="../../../tables/stylesheet.css" rel="stylesheet">
  </head>
  <body>
      <p>
      Popis útoku: základní útok, v rámci uměle vytvořené transakce se uloží pointer do lokální proměnné, která po ukončení transakce není zpět nastavená na null, takže může validně přistupovat k paměti, kam ukazuje.
      </p>
      <table>
        <tbody>
          <caption>BasicTransaction</caption>
          <tr>
            <th>card-name</th>
            <th>installation</th>
            <th>send INS_PREPARE1</th>
            <th>send INS_PREPARE2</th>
            <th>send INS_READMEM at 0000</th>
            <th>send INS_READMEM at 0020</th>
            <th>send INS_READMEM at 3017</th>
            <th>send INS_READMEM at 3201</th>
            <th>send INS_READMEM at 4000</th>
            <th>send INS_READMEM at 5000</th>
            <th>uninstallation</th>
            <th>comment</th>
          </tr>
          <tr>
            <td>A</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td></td>
          </tr>
          <tr>
            <td>B</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td><span style="color: orange;">&#9898;</span></br>6A80</br>Wrong data</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td></td>
          </tr>
          <tr style="background-color: #add8e6;">
            <td>C</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td><span style="color: green;">&#10004;</span></br>A<< (0004+2) (209ms) 00800080 9000</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6D00</br>INS value not supported</td>
            <td><span style="color: orange;">&#9898;</span></br>6D00</br>INS value not supported</td>
            <td><span style="color: orange;">&#9898;</span></br>6D00</br>INS value not supported</td>
            <td><span style="color: orange;">&#9898;</span></br>6D00</br>INS value not supported</td>
            <td><span style="color: orange;">&#9898;</span></br>6D00</br>INS value not supported</td>
            <td><span style="color: orange;">&#9898;</span></br>6D00</br>INS value not supported</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td>Nejzajímavější chování, protože karta alespoň nechala proběhnout PREPARE1 fázi, což je právě fáze s transakcí.</td>
          </tr>
          <tr>
            <td>D</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td><span style="color: orange;">&#9898;</span></br>6A80</br>Wrong data</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td></td>
          </tr>
          <tr>
            <td>E</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td><span style="color: orange;">&#9898;</span></br>6A80</br>Wrong data</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td></td>
          </tr>
          <tr>
            <td>F</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td> SCARD_E_NOT_TRANSACTED</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td></td>
          </tr>
          <tr>
            <td>G</td>
            <td><span style="color: red;">&#10060;</span></br>[WARN] GlobalPlatform - GET STATUS failed for 80F21000024F0000 with 0x6A86 (Incorrect P1/P2)</br>LOAD failed: 0x6484</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td></td>
          </tr>
          <tr>
            <td>H</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td> SCARD_E_NOT_TRANSACTED</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td></td>
          </tr>
          <tr>
            <td>I</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td> SCARD_E_NOT_TRANSACTED</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: orange;">&#9898;</span></br>6F00</br>No precise diagnosis</td>
            <td><span style="color: green;">&#10004;</span></td>
            <td></td>
          </tr>
        </tbody>
      </table>
  </body>
</html>
