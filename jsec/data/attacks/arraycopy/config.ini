[BUILD]
# TODO what about jc212
versions = jc221,jc222,jc303,jc304,jc305u1,jc305u2,jc305u3
unsupported.versions = jc211,jc310b43
genidx = 1
genarg = 0
# those are the default values, however during the analysis those values might be altered
# because an applet/package with the same AID can already be installed
# TODO test rid is always before pix
pkg.rid = A000000065
vulns.pix = 03010C02
pkg.pix = 03010C01
applet.pix = 03010C0101

[STAGES]
# the right side of install must be relative to the directory if the attack
# there can be multiple installs
install = build/{version}/com/se/applets/javacard/applets.cap
install = build/{version}/com/se/vulns/javacard/vulns.new.cap
send_read_mem  = 0x80 0x10 0x01 0x02	0x04	0x00 0x00 0xc0 0x00				0x7F
send_write_mem = 0x80 0x11 0x01 0x02	0x08	0x00 0x0a 0x04 0x00 0xaa 0xbb 0xcc 0xdd		0x7F
send_write_mem = 0x80 0x11 0x01 0x02	0x08	0x00 0x0e 0x04 0x01 0x11 0x22 0x33 0x44		0x7F
send_read_mem  = 0x80 0x10 0x01 0x02	0x04	0x00 0x00 0xc0 0x01				0x7F
# only single uninstall, that attempts to uninstall the applets in the reverse order,
# in which they've been installed
uninstall = yes
